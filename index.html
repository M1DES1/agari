<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agario Multiplayer - Menu</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* ... (poprzednie style pozostajƒÖ) ... */
        
        .notification {
            animation: slideInRight 0.3s ease-out;
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100%);
            }
        }
    </style>
</head>
<body>
    <div class="menu-container">
        <div class="menu-background">
            <div class="bg-circle" style="top: 10%; left: 10%; animation-delay: 0s;"></div>
            <div class="bg-circle" style="top: 60%; left: 80%; animation-delay: 0.5s;"></div>
            <div class="bg-circle" style="top: 30%; left: 70%; animation-delay: 1s;"></div>
            <div class="bg-circle" style="top: 80%; left: 20%; animation-delay: 1.5s;"></div>
            <div class="bg-circle" style="top: 40%; left: 40%; animation-delay: 2s;"></div>
        </div>
        
        <div class="menu-box">
            <div class="logo-header">
                <div class="floating-icon" style="font-size: 4rem; margin-bottom: 10px;">
                    üéÆ
                </div>
                <h1 class="glowing-text">AGARIO MULTIPLAYER</h1>
                <div class="game-subtitle">
                    <span class="pulse-dot"></span>
                    <span>EXTENDED EDITION</span>
                    <span class="pulse-dot"></span>
                </div>
            </div>
            
            <div class="player-setup">
                <div class="setup-card">
                    <div class="setup-header">
                        <i class="fas fa-user-circle"></i>
                        <h3>Tw√≥j Profil</h3>
                    </div>
                    
                    <div class="input-group">
                        <div class="input-with-icon">
                            <i class="fas fa-user-tag"></i>
                            <input type="text" 
                                   id="nickname" 
                                   placeholder="Wpisz sw√≥j nick..." 
                                   maxlength="15"
                                   value="Gracz">
                        </div>
                        <div class="hint">
                            <i class="fas fa-info-circle"></i>
                            Maksymalnie 15 znak√≥w
                        </div>
                    </div>
                    
                    <div class="color-picker">
                        <div class="picker-header">
                            <i class="fas fa-palette"></i>
                            <h4>Kolor Twojej kulki</h4>
                        </div>
                        <div class="colors">
                            <div class="color-option" style="background: #FF5252" data-color="#FF5252" title="Czerwony">
                                <div class="color-check"><i class="fas fa-check"></i></div>
                            </div>
                            <div class="color-option" style="background: #4CAF50" data-color="#4CAF50" title="Zielony">
                                <div class="color-check"><i class="fas fa-check"></i></div>
                            </div>
                            <div class="color-option" style="background: #2196F3" data-color="#2196F3" title="Niebieski">
                                <div class="color-check"><i class="fas fa-check"></i></div>
                            </div>
                            <div class="color-option" style="background: #FFC107" data-color="#FFC107" title="≈ª√≥≈Çty">
                                <div class="color-check"><i class="fas fa-check"></i></div>
                            </div>
                            <div class="color-option" style="background: #9C27B0" data-color="#9C27B0" title="Fioletowy">
                                <div class="color-check"><i class="fas fa-check"></i></div>
                            </div>
                            <div class="color-option" style="background: #00BCD4" data-color="#00BCD4" title="Cyjan">
                                <div class="color-check"><i class="fas fa-check"></i></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- NOWA SEKCJA: Wgrywanie grafiki -->
                    <div class="image-upload-section" id="imageUploadSection">
                        <div class="picker-header">
                            <i class="fas fa-image"></i>
                            <h4>W≈Çasna grafika kulki</h4>
                        </div>
                        <input type="file" 
                               id="imageUpload" 
                               accept="image/*" 
                               style="display: none;">
                        <button id="imageUploadBtn" class="image-upload-btn">
                            <i class="fas fa-upload"></i>
                            Wybierz grafikƒô
                        </button>
                        <div class="image-hint">
                            <i class="fas fa-info-circle"></i>
                            Wybierz obraz (PNG, JPG, GIF). Maksymalnie 2MB.
                        </div>
                        <div class="image-preview" id="imagePreview">
                            <img id="previewImage" src="" alt="PodglƒÖd">
                            <button id="removeImageBtn" class="remove-image-btn">
                                <i class="fas fa-trash"></i>
                                Usu≈Ñ
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="setup-card">
                    <div class="setup-header">
                        <i class="fas fa-microphone"></i>
                        <h3>Voice Chat</h3>
                    </div>
                    
                    <div class="voice-settings">
                        <div class="voice-permission">
                            <div class="toggle-switch">
                                <input type="checkbox" id="voicePermission" checked>
                                <label for="voicePermission" class="toggle-label">
                                    <span class="toggle-slider"></span>
                                    <span class="toggle-text">W≈ÇƒÖcz Voice Chat</span>
                                </label>
                            </div>
                            <div class="hint voice-hint">
                                <i class="fas fa-headphones"></i>
                                Zalecane u≈ºywanie s≈Çuchawek
                            </div>
                        </div>
                        
                        <div class="voice-info">
                            <div class="info-item">
                                <i class="fas fa-volume-up"></i>
                                <span>Komunikacja g≈Çosowa w czasie rzeczywistym</span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-ruler"></i>
                                <span>Zasiƒôg: 20 metr√≥w</span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-users"></i>
                                <span>S≈Çyszysz tylko graczy w zasiƒôgu</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <button id="playBtn" class="play-btn">
                <i class="fas fa-play-circle"></i>
                <span class="btn-text">ROZPOCZNIJ GRƒò</span>
                <div class="btn-glow"></div>
            </button>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-microphone-alt"></i>
                    </div>
                    <h4>Voice Chat 20m</h4>
                    <p>Rozmawiaj z graczami w pobli≈ºu</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);">
                        <i class="fas fa-users"></i>
                    </div>
                    <h4>Multiplayer Online</h4>
                    <p>Graj z graczami z ca≈Çego ≈õwiata</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon" style="background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <h4>Zbieraj Jedzenie</h4>
                    <p>1000 kulek do zbierania</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon" style="background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);">
                        <i class="fas fa-running"></i>
                    </div>
                    <h4>UciekajƒÖce Kulki</h4>
                    <p>≈öcigaj ≈õwiecƒÖce wirusy</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon" style="background: linear-gradient(135deg, #9C27B0 0%, #7B1FA2 100%);">
                        <i class="fas fa-crosshairs"></i>
                    </div>
                    <h4>Strzelanie Kulki</h4>
                    <p>Wystrzeliwuj czƒô≈õƒá siebie</p>
                </div>
                
                <div class="feature-card">
                    <div class="feature-icon" style="background: linear-gradient(135deg, #00BCD4 0%, #0097A7 100%);">
                        <i class="fas fa-image"></i>
                    </div>
                    <h4>W≈Çasna Grafika</h4>
                    <p>Wgraj w≈Çasne logo</p>
                </div>
            </div>
            
            <div class="game-instructions">
                <div class="instructions-header">
                    <i class="fas fa-gamepad"></i>
                    <h3>Sterowanie</h3>
                </div>
                
                <div class="controls-grid">
                    <div class="control-item">
                        <div class="key-group">
                            <kbd>W</kbd>
                            <kbd>A</kbd>
                            <kbd>S</kbd>
                            <kbd>D</kbd>
                        </div>
                        <span>Ruch kulki</span>
                    </div>
                    
                    <div class="control-item">
                        <div class="key-group">
                            <kbd><i class="fas fa-arrow-up"></i></kbd>
                            <kbd><i class="fas fa-arrow-left"></i></kbd>
                            <kbd><i class="fas fa-arrow-down"></i></kbd>
                            <kbd><i class="fas fa-arrow-right"></i></kbd>
                        </div>
                        <span>Alternatywny ruch</span>
                    </div>
                    
                    <div class="control-item">
                        <kbd class="key-large">V</kbd>
                        <span>M√≥w przez voice chat</span>
                    </div>
                    
                    <div class="control-item">
                        <kbd class="key-large">T</kbd>
                        <span>Otw√≥rz czat tekstowy</span>
                    </div>
                    
                    <div class="control-item">
                        <div class="scroll-icon">
                            <i class="fas fa-mouse"></i>
                            <i class="fas fa-arrows-alt-v"></i>
                        </div>
                        <span>Zoom mapy</span>
                    </div>
                    
                    <div class="control-item">
                        <kbd class="key-large"><i class="fas fa-mouse-pointer"></i></kbd>
                        <span>Kliknij na minimapƒô</span>
                    </div>
                    
                    <div class="control-item">
                        <kbd class="key-large">SHIFT</kbd>
                        <span>Przytrzymaj do strza≈Çu</span>
                    </div>
                    
                    <div class="control-item">
                        <kbd class="key-large">SPACJA</kbd>
                        <span>Strzel kulki (ze SHIFT)</span>
                    </div>
                </div>
                
                <div class="game-tip">
                    <i class="fas fa-lightbulb"></i>
                    <p><strong>Strategia:</strong> Zacznij od ma≈Çych kulek, jedz wirusy dla bonusu x10, strzelaj kulki aby atakowaƒá wiƒôkszych graczy!</p>
                </div>
            </div>
            
            <div class="server-status">
                <div class="status-indicator">
                    <div class="status-dot"></div>
                    <div class="status-pulse"></div>
                </div>
                <div class="status-info">
                    <span id="statusText" class="status-text">üü¢ Serwer gotowy</span>
                    <span class="status-subtext">Po≈ÇƒÖcz siƒô z graczami na ca≈Çym ≈õwiecie</span>
                </div>
            </div>
            
            <div class="footer-info">
                <div class="version">v4.0 ‚Ä¢ Extended Edition</div>
                <div class="creator">
                    <i class="fas fa-code"></i>
                    Nowe funkcje: Jedzenie, Wirusy, Strzelanie, Grafiki
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const playBtn = document.getElementById('playBtn');
            const nicknameInput = document.getElementById('nickname');
            const voicePermission = document.getElementById('voicePermission');
            const imageUpload = document.getElementById('imageUpload');
            const imageUploadBtn = document.getElementById('imageUploadBtn');
            const imagePreview = document.getElementById('imagePreview');
            const previewImage = document.getElementById('previewImage');
            const removeImageBtn = document.getElementById('removeImageBtn');
            const imageUploadSection = document.getElementById('imageUploadSection');
            
            let selectedImageUrl = null;
            
            // Animacja przycisku gry
            playBtn.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px) scale(1.02)';
            });
            
            playBtn.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
            
            // Wyb√≥r koloru
            document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.color-option').forEach(opt => {
                        opt.classList.remove('selected');
                        opt.querySelector('.color-check').style.opacity = '0';
                    });
                    this.classList.add('selected');
                    this.querySelector('.color-check').style.opacity = '1';
                    
                    this.style.transform = 'scale(1.2)';
                    setTimeout(() => {
                        this.style.transform = 'scale(1)';
                    }, 200);
                });
                
                option.addEventListener('mouseenter', function() {
                    if (!this.classList.contains('selected')) {
                        this.style.transform = 'scale(1.1)';
                    }
                });
                
                option.addEventListener('mouseleave', function() {
                    if (!this.classList.contains('selected')) {
                        this.style.transform = 'scale(1)';
                    }
                });
            });
            
            // Wybierz domy≈õlny kolor
            document.querySelectorAll('.color-option')[0].classList.add('selected');
            document.querySelectorAll('.color-option')[0].querySelector('.color-check').style.opacity = '1';
            
            // Wgrywanie grafiki
            imageUploadBtn.addEventListener('click', () => {
                imageUpload.click();
            });
            
            imageUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 2 * 1024 * 1024) {
                        showNotification('Plik jest za du≈ºy! Maksymalnie 2MB.', 'error');
                        return;
                    }
                    
                    if (!file.type.match('image.*')) {
                        showNotification('Proszƒô wybraƒá plik graficzny!', 'error');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        selectedImageUrl = e.target.result;
                        previewImage.src = selectedImageUrl;
                        imagePreview.style.display = 'block';
                        showNotification('Grafika za≈Çadowana pomy≈õlnie!', 'success');
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Usuwanie grafiki
            removeImageBtn.addEventListener('click', function() {
                selectedImageUrl = null;
                previewImage.src = '';
                imagePreview.style.display = 'none';
                imageUpload.value = '';
                showNotification('Grafika usuniƒôta', 'info');
            });
            
            // Drag & drop dla grafiki
            imageUploadSection.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('drag-over');
            });
            
            imageUploadSection.addEventListener('dragleave', function() {
                this.classList.remove('drag-over');
            });
            
            imageUploadSection.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('drag-over');
                
                const file = e.dataTransfer.files[0];
                if (file) {
                    if (file.size > 2 * 1024 * 1024) {
                        showNotification('Plik jest za du≈ºy! Maksymalnie 2MB.', 'error');
                        return;
                    }
                    
                    if (!file.type.match('image.*')) {
                        showNotification('Proszƒô wybraƒá plik graficzny!', 'error');
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        selectedImageUrl = e.target.result;
                        previewImage.src = selectedImageUrl;
                        imagePreview.style.display = 'block';
                        showNotification('Grafika za≈Çadowana pomy≈õlnie!', 'success');
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Rozpoczƒôcie gry
            playBtn.addEventListener('click', function() {
                const nickname = nicknameInput.value.trim();
                const selectedColor = document.querySelector('.color-option.selected')?.dataset.color || '#FF5252';
                const allowVoice = voicePermission.checked;
                
                if (!nickname) {
                    showNotification('Proszƒô wpisaƒá nick!', 'error');
                    nicknameInput.focus();
                    return;
                }
                
                if (nickname.length < 2) {
                    showNotification('Nick musi mieƒá co najmniej 2 znaki!', 'error');
                    nicknameInput.focus();
                    return;
                }
                
                // Animacja klikniƒôcia
                this.style.transform = 'scale(0.95)';
                this.style.opacity = '0.8';
                
                setTimeout(() => {
                    this.style.transform = 'scale(1)';
                    this.style.opacity = '1';
                    
                    // Zapisz dane
                    localStorage.setItem('playerData', JSON.stringify({
                        nickname: nickname,
                        color: selectedColor,
                        allowVoice: allowVoice,
                        imageUrl: selectedImageUrl,
                        timestamp: Date.now()
                    }));
                    
                    // Przejd≈∫ do gry
                    window.location.href = 'game.html';
                }, 200);
            });
            
            function showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.innerHTML = `
                    <i class="fas fa-${type === 'error' ? 'exclamation-circle' : 
                                      type === 'success' ? 'check-circle' : 
                                      type === 'warning' ? 'exclamation-triangle' : 
                                      'info-circle'}"></i>
                    <span>${message}</span>
                `;
                
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: ${type === 'error' ? '#F44336' : 
                                type === 'success' ? '#4CAF50' : 
                                type === 'warning' ? '#FF9800' : '#2196F3'};
                    color: white;
                    padding: 15px 25px;
                    border-radius: 10px;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    z-index: 10000;
                    animation: slideInRight 0.3s ease-out;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                `;
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideOutRight 0.3s ease-out';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }
            
            // Enter te≈º zaczyna grƒô
            nicknameInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    playBtn.click();
                }
            });
            
            // Auto-focus i wyb√≥r tekstu
            setTimeout(() => {
                nicknameInput.focus();
                nicknameInput.select();
            }, 500);
            
            // Pokazuj liczbƒô znak√≥w
            nicknameInput.addEventListener('input', function() {
                const length = this.value.length;
                const max = 15;
                
                if (length > max - 3) {
                    this.style.borderColor = '#FF9800';
                } else {
                    this.style.borderColor = '#ddd';
                }
            });
            
            // Sprawd≈∫ po≈ÇƒÖczenie z serwerem
            checkServerStatus();
            
            async function checkServerStatus() {
                const statusText = document.getElementById('statusText');
                const statusDot = document.querySelector('.status-dot');
                
                if (!statusText || !statusDot) return;
                
                try {
                    statusText.textContent = "üü° ≈ÅƒÖczenie z serwerem...";
                    statusDot.style.background = '#FFC107';
                    
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    statusText.textContent = "üü¢ Serwer gotowy";
                    statusDot.style.background = '#4CAF50';
                    
                } catch (error) {
                    statusText.textContent = "üî¥ B≈ÇƒÖd po≈ÇƒÖczenia";
                    statusDot.style.background = '#F44336';
                    showNotification('Nie uda≈Ço siƒô po≈ÇƒÖczyƒá z serwerem', 'error');
                }
            }
            
            // ≈Åaduj zapisanƒÖ grafikƒô je≈õli istnieje
            const savedPlayerData = JSON.parse(localStorage.getItem('playerData') || '{}');
            if (savedPlayerData.imageUrl) {
                selectedImageUrl = savedPlayerData.imageUrl;
                previewImage.src = selectedImageUrl;
                imagePreview.style.display = 'block';
            }
            
            // ≈Åaduj zapisany nick je≈õli istnieje
            if (savedPlayerData.nickname && savedPlayerData.nickname !== "Gracz") {
                nicknameInput.value = savedPlayerData.nickname;
            }
            
            // ≈Åaduj zapisany kolor je≈õli istnieje
            if (savedPlayerData.color) {
                document.querySelectorAll('.color-option').forEach(option => {
                    if (option.dataset.color === savedPlayerData.color) {
                        option.classList.add('selected');
                        option.querySelector('.color-check').style.opacity = '1';
                    } else {
                        option.classList.remove('selected');
                        option.querySelector('.color-check').style.opacity = '0';
                    }
                });
            }
            
            // ≈Åaduj ustawienie voice chatu
            if (savedPlayerData.allowVoice !== undefined) {
                voicePermission.checked = savedPlayerData.allowVoice;
            }
        });
    </script>
</body>
</html>
